---
// Simple AirBnb-style warehouse showcase
import Navigation from '../components/Navigation.astro';
import Footer from '../components/Footer.astro';
import BaseLayout from '../layouts/BaseLayout.astro';

// Curated warehouse data - 4 per county for optimal UX
const warehousesByCounty = {
  "Miami-Dade": [
    {
      id: 1,
      title: "Modern Distribution Center",
      location: "Doral, FL",
      size: "85,000 SF",
      price: "$12.50",
      type: "Distribution",
      image: "https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=800&h=600&fit=crop",
      available: true
    },
    {
      id: 2,
      title: "Prime Warehouse Space",
      location: "Hialeah, FL",
      size: "45,000 SF",
      price: "$10.75",
      type: "Warehouse",
      image: "https://images.unsplash.com/photo-1565884280-4e2b1f6b1b1e?w=800&h=600&fit=crop",
      available: true
    },
    {
      id: 3,
      title: "Manufacturing Facility",
      location: "Miami, FL",
      size: "120,000 SF",
      price: "$15.00",
      type: "Manufacturing",
      image: "https://images.unsplash.com/photo-1504307651254-35680f356dfd?w=800&h=600&fit=crop",
      available: true
    },
    {
      id: 7,
      title: "Cold Storage Facility",
      location: "Miami Beach, FL",
      size: "35,000 SF",
      price: "$18.00",
      type: "Cold Storage",
      image: "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800&h=600&fit=crop",
      available: true
    }
  ],
  "Broward": [
    {
      id: 4,
      title: "Flex Industrial Space",
      location: "Pompano Beach, FL",
      size: "25,000 SF",
      price: "$14.25",
      type: "Flex Space",
      image: "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800&h=600&fit=crop",
      available: true
    },
    {
      id: 5,
      title: "Logistics Hub",
      location: "Fort Lauderdale, FL",
      size: "95,000 SF",
      price: "$11.80",
      type: "Distribution",
      image: "https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=800&h=600&fit=crop",
      available: true
    },
    {
      id: 9,
      title: "Distribution Warehouse",
      location: "Hollywood, FL",
      size: "75,000 SF",
      price: "$13.25",
      type: "Distribution",
      image: "https://images.unsplash.com/photo-1565884280-4e2b1f6b1b1e?w=800&h=600&fit=crop",
      available: true
    },
    {
      id: 11,
      title: "Port Access Facility",
      location: "Dania Beach, FL",
      size: "60,000 SF",
      price: "$12.75",
      type: "Warehouse",
      image: "https://images.unsplash.com/photo-1504307651254-35680f356dfd?w=800&h=600&fit=crop",
      available: true
    }
  ],
  "Palm Beach": [
    {
      id: 6,
      title: "Industrial Complex",
      location: "Boca Raton, FL",
      size: "65,000 SF",
      price: "$13.50",
      type: "Warehouse",
      image: "https://images.unsplash.com/photo-1565884280-4e2b1f6b1b1e?w=800&h=600&fit=crop",
      available: true
    },
    {
      id: 10,
      title: "Tech Manufacturing Hub",
      location: "Delray Beach, FL",
      size: "110,000 SF",
      price: "$16.75",
      type: "Manufacturing",
      image: "https://images.unsplash.com/photo-1504307651254-35680f356dfd?w=800&h=600&fit=crop",
      available: true
    },
    {
      id: 12,
      title: "Multi-Use Industrial",
      location: "West Palm Beach, FL",
      size: "80,000 SF",
      price: "$14.50",
      type: "Flex Space",
      image: "https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=800&h=600&fit=crop",
      available: true
    },
    {
      id: 13,
      title: "Distribution Center",
      location: "Boynton Beach, FL",
      size: "90,000 SF",
      price: "$13.25",
      type: "Distribution",
      image: "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800&h=600&fit=crop",
      available: true
    }
  ]
};
---

<BaseLayout title="South Florida Warehouses | Shallow Bay Advisors">
  <Navigation />

  <main class="min-h-screen bg-gray-100">

    <!-- Simple AirBnb-style Hero -->
    <section class="pt-28 pb-16">
      <div class="max-w-7xl mx-auto px-6 lg:px-8">

        <!-- Simple Headline -->
        <div class="text-center mb-12">
          <h1 class="text-4xl md:text-5xl font-light text-sba-navy mb-6 font-['Poppins'] tracking-tight leading-tight">
            Where you find your warehouse
          </h1>
          <p class="text-lg text-gray-600 max-w-2xl mx-auto">
            Discover industrial properties across South Florida
          </p>
        </div>

        <!-- AirBnb-style Search Bar -->
        <div class="flex justify-center mb-16">
          <div id="floating-search-bar" class="bg-white border border-gray-300 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 p-1 max-w-4xl w-full">
            <div class="flex items-center">
              <div class="flex-1 px-6 py-4 border-r border-gray-300">
                <div class="text-xs font-semibold text-gray-700 mb-1">County</div>
                <select id="county-select" class="text-sm text-gray-800 w-full border-none outline-none bg-transparent appearance-none cursor-pointer">
                  <option value="">All counties</option>
                  <option value="Miami-Dade">Miami-Dade</option>
                  <option value="Broward">Broward</option>
                  <option value="Palm Beach">Palm Beach</option>
                </select>
              </div>
              <div class="flex-1 px-6 py-4 border-r border-gray-300">
                <div class="text-xs font-semibold text-gray-700 mb-1">Size</div>
                <select id="size-select" class="text-sm text-gray-800 w-full border-none outline-none bg-transparent appearance-none cursor-pointer">
                  <option value="">Any size</option>
                  <option value="small">5K - 25K SF</option>
                  <option value="medium">25K - 100K SF</option>
                  <option value="large">100K+ SF</option>
                </select>
              </div>
              <div class="flex-1 px-6 py-4">
                <div class="text-xs font-semibold text-gray-700 mb-1">Type</div>
                <select id="type-select" class="text-sm text-gray-800 w-full border-none outline-none bg-transparent appearance-none cursor-pointer">
                  <option value="">All types</option>
                  <option value="warehouse">Warehouse</option>
                  <option value="distribution">Distribution</option>
                  <option value="manufacturing">Manufacturing</option>
                  <option value="flex">Flex Space</option>
                </select>
              </div>
            </div>
          </div>
        </div>

      </div>
    </section>

    <!-- AirBnb-style Properties -->
    <section class="pb-24">
      <div class="max-w-7xl mx-auto px-6">

        <!-- All Properties Grid - No County Separation -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-6">
          {Object.entries(warehousesByCounty).flatMap(([county, warehouses]) =>
            warehouses.map((warehouse) => (
              <div class="group cursor-pointer transition-all duration-200">

                <!-- Simple Property Image -->
                <div class="relative overflow-hidden rounded-lg mb-3" style="aspect-ratio: 20/19;">
                  <img
                    src={warehouse.image}
                    alt={warehouse.title}
                    class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"
                  />
                </div>

                <!-- Simple Text Below Like LoopNet -->
                <div class="space-y-2">
                  <h3 class="font-semibold text-sba-navy text-sm leading-tight">
                    {warehouse.title}
                  </h3>

                  <p class="text-gray-600 text-sm">
                    {warehouse.location}
                  </p>

                  <div class="flex items-center justify-between">
                    <div class="text-sm text-gray-600">
                      {warehouse.size} • {warehouse.type}
                    </div>
                    <div class="font-semibold text-sba-navy">
                      {warehouse.price}/SF
                    </div>
                  </div>
                </div>

              </div>
            ))
          )}
        </div>

        <!-- View All Properties -->
        <div class="text-center mt-16 pt-8 border-t border-gray-300">
          <a
            href="/properties"
            class="text-gray-600 hover:text-sba-navy font-medium underline transition-colors"
          >
            Show all properties
          </a>
        </div>

      </div>
    </section>

    <!-- Professional CTA Section -->
    <section class="py-32 bg-gradient-to-br from-sba-navy to-blue-900 relative overflow-hidden">
      <!-- Subtle background elements -->
      <div class="absolute inset-0">
        <div class="absolute top-0 left-1/4 w-96 h-96 bg-white/5 rounded-full blur-3xl"></div>
        <div class="absolute bottom-0 right-1/4 w-72 h-72 bg-blue-400/10 rounded-full blur-2xl"></div>
      </div>

      <div class="max-w-6xl mx-auto px-6 text-center relative z-10">
        <!-- Professional headline -->
        <div class="mb-16">
          <span class="inline-block bg-white/10 backdrop-blur-sm text-white px-6 py-3 rounded-lg text-sm font-bold uppercase tracking-wider border border-white/20 mb-8">
            Ready to Move Forward?
          </span>
          <h2 class="text-5xl md:text-6xl lg:text-7xl font-black text-white mb-8 leading-none">
            <span class="block">Partner with</span>
            <span class="block text-blue-300">The Experts</span>
          </h2>
          <p class="text-2xl md:text-3xl text-blue-100 max-w-4xl mx-auto font-medium leading-relaxed">
            Get professional guidance and access to
            <span class="text-white font-bold">South Florida's best industrial properties.</span>
            <span class="block mt-2 text-xl">Let's find your perfect space today.</span>
          </p>
        </div>

        <!-- Professional CTAs -->
        <div class="flex flex-col lg:flex-row gap-6 justify-center items-center max-w-4xl mx-auto">
          <a href="/book-consultation" class="group bg-white text-sba-navy px-12 py-6 rounded-xl font-bold text-lg hover:bg-blue-50 transition-all duration-300 shadow-xl hover:shadow-2xl transform hover:scale-105 w-full lg:w-auto">
            <div class="flex items-center justify-center space-x-3">
              <span>Schedule Consultation</span>
              <svg class="w-6 h-6 group-hover:translate-x-1 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
              </svg>
            </div>
            <div class="text-sm font-medium mt-1 opacity-75">Professional consultation • Free initial meeting</div>
          </a>

          <div class="text-white font-medium text-lg lg:mx-8">or</div>

          <a href="/contact" class="group border-2 border-white/30 backdrop-blur-sm text-white px-12 py-6 rounded-xl font-bold text-lg hover:bg-white hover:text-sba-navy transition-all duration-300 transform hover:scale-105 w-full lg:w-auto">
            <div class="flex items-center justify-center space-x-3">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 7.89a2 2 0 002.83 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
              </svg>
              <span>Contact Our Team</span>
            </div>
            <div class="text-sm font-medium mt-1 opacity-75">Direct access to our specialists</div>
          </a>
        </div>

        <!-- Professional trust indicators -->
        <div class="mt-20 pt-12 border-t border-white/20">
          <p class="text-white/90 text-lg font-medium mb-8">Serving South Florida's Leading Businesses</p>
          <div class="flex flex-wrap justify-center items-center gap-12 opacity-80">
            <div class="bg-white/10 backdrop-blur-sm px-6 py-4 rounded-lg border border-white/20">
              <span class="text-white font-bold text-lg">25+ Years Experience</span>
            </div>
            <div class="bg-white/10 backdrop-blur-sm px-6 py-4 rounded-lg border border-white/20">
              <span class="text-white font-bold text-lg">Licensed Professionals</span>
            </div>
            <div class="bg-white/10 backdrop-blur-sm px-6 py-4 rounded-lg border border-white/20">
              <span class="text-white font-bold text-lg">Local Market Experts</span>
            </div>
          </div>
        </div>
      </div>
    </section>

  </main>

  <Footer />
</BaseLayout>

<style>
  /* Clean minimal styling */
  select {
    appearance: none;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
    background-position: right 12px center;
    background-repeat: no-repeat;
    background-size: 16px;
  }

  select:focus,
  input:focus {
    outline: none;
  }

  html {
    scroll-behavior: smooth;
  }

  select:focus-visible,
  button:focus-visible,
  a:focus-visible {
    outline: 2px solid #1f2937;
    outline-offset: 2px;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const floatingSearchBar = document.getElementById('floating-search-bar');
    const countySelect = document.getElementById('county-select');
    const sizeSelect = document.getElementById('size-select');
    const typeSelect = document.getElementById('type-select');
    const propertiesGrid = document.querySelector('.grid.grid-cols-1');

    // All warehouse data for filtering
    const warehouseData = {
      "Miami-Dade": [
        {
          id: 1,
          title: "Modern Distribution Center",
          location: "Doral, FL",
          size: "85,000 SF",
          sizeValue: 85000,
          price: "$12.50",
          type: "Distribution",
          typeValue: "distribution",
          image: "https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=800&h=600&fit=crop",
          available: true
        },
        {
          id: 2,
          title: "Prime Warehouse Space",
          location: "Hialeah, FL",
          size: "45,000 SF",
          sizeValue: 45000,
          price: "$10.75",
          type: "Warehouse",
          typeValue: "warehouse",
          image: "https://images.unsplash.com/photo-1565884280-4e2b1f6b1b1e?w=800&h=600&fit=crop",
          available: true
        },
        {
          id: 3,
          title: "Manufacturing Facility",
          location: "Miami, FL",
          size: "120,000 SF",
          sizeValue: 120000,
          price: "$15.00",
          type: "Manufacturing",
          typeValue: "manufacturing",
          image: "https://images.unsplash.com/photo-1504307651254-35680f356dfd?w=800&h=600&fit=crop",
          available: true
        },
        {
          id: 7,
          title: "Cold Storage Facility",
          location: "Miami Beach, FL",
          size: "35,000 SF",
          sizeValue: 35000,
          price: "$18.00",
          type: "Cold Storage",
          typeValue: "warehouse",
          image: "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800&h=600&fit=crop",
          available: true
        }
      ],
      "Broward": [
        {
          id: 4,
          title: "Flex Industrial Space",
          location: "Pompano Beach, FL",
          size: "25,000 SF",
          sizeValue: 25000,
          price: "$14.25",
          type: "Flex Space",
          typeValue: "flex",
          image: "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800&h=600&fit=crop",
          available: true
        },
        {
          id: 5,
          title: "Logistics Hub",
          location: "Fort Lauderdale, FL",
          size: "95,000 SF",
          sizeValue: 95000,
          price: "$11.80",
          type: "Distribution",
          typeValue: "distribution",
          image: "https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=800&h=600&fit=crop",
          available: true
        },
        {
          id: 9,
          title: "Distribution Warehouse",
          location: "Hollywood, FL",
          size: "75,000 SF",
          sizeValue: 75000,
          price: "$13.25",
          type: "Distribution",
          typeValue: "distribution",
          image: "https://images.unsplash.com/photo-1565884280-4e2b1f6b1b1e?w=800&h=600&fit=crop",
          available: true
        },
        {
          id: 11,
          title: "Port Access Facility",
          location: "Dania Beach, FL",
          size: "60,000 SF",
          sizeValue: 60000,
          price: "$12.75",
          type: "Warehouse",
          typeValue: "warehouse",
          image: "https://images.unsplash.com/photo-1504307651254-35680f356dfd?w=800&h=600&fit=crop",
          available: true
        }
      ],
      "Palm Beach": [
        {
          id: 6,
          title: "Industrial Complex",
          location: "Boca Raton, FL",
          size: "65,000 SF",
          sizeValue: 65000,
          price: "$13.50",
          type: "Warehouse",
          typeValue: "warehouse",
          image: "https://images.unsplash.com/photo-1565884280-4e2b1f6b1b1e?w=800&h=600&fit=crop",
          available: true
        },
        {
          id: 10,
          title: "Tech Manufacturing Hub",
          location: "Delray Beach, FL",
          size: "110,000 SF",
          sizeValue: 110000,
          price: "$16.75",
          type: "Manufacturing",
          typeValue: "manufacturing",
          image: "https://images.unsplash.com/photo-1504307651254-35680f356dfd?w=800&h=600&fit=crop",
          available: true
        },
        {
          id: 12,
          title: "Multi-Use Industrial",
          location: "West Palm Beach, FL",
          size: "80,000 SF",
          sizeValue: 80000,
          price: "$14.50",
          type: "Flex Space",
          typeValue: "flex",
          image: "https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=800&h=600&fit=crop",
          available: true
        },
        {
          id: 13,
          title: "Distribution Center",
          location: "Boynton Beach, FL",
          size: "90,000 SF",
          sizeValue: 90000,
          price: "$13.25",
          type: "Distribution",
          typeValue: "distribution",
          image: "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800&h=600&fit=crop",
          available: true
        }
      ]
    };

    // Search bar shrinking behavior on scroll
    let lastScrollY = window.scrollY;
    let isCompact = false;

    function updateSearchBarOnScroll() {
      const currentScrollY = window.scrollY;

      if (currentScrollY > 200 && !isCompact) {
        // Shrink search bar
        floatingSearchBar.style.transform = 'scale(0.8)';
        floatingSearchBar.style.maxWidth = '700px';
        isCompact = true;
      } else if (currentScrollY <= 200 && isCompact) {
        // Expand search bar back to normal
        floatingSearchBar.style.transform = 'scale(1)';
        floatingSearchBar.style.maxWidth = '1280px';
        isCompact = false;
      }

      lastScrollY = currentScrollY;
    }

    // Throttle scroll events for performance
    let ticking = false;
    window.addEventListener('scroll', function() {
      if (!ticking) {
        requestAnimationFrame(updateSearchBarOnScroll);
        ticking = true;
        setTimeout(() => { ticking = false; }, 10);
      }
    });

    // Filter properties based on search criteria
    function filterProperties() {
      const county = countySelect ? countySelect.value : '';
      const size = sizeSelect ? sizeSelect.value : '';
      const type = typeSelect ? typeSelect.value : '';

      let filteredProperties = [];

      // Get all properties or filter by county
      if (county) {
        filteredProperties = warehouseData[county] || [];
      } else {
        // Get all properties from all counties
        filteredProperties = Object.values(warehouseData).flat();
      }

      // Filter by size
      if (size) {
        filteredProperties = filteredProperties.filter(property => {
          switch (size) {
            case 'small':
              return property.sizeValue >= 5000 && property.sizeValue <= 25000;
            case 'medium':
              return property.sizeValue > 25000 && property.sizeValue <= 100000;
            case 'large':
              return property.sizeValue > 100000;
            default:
              return true;
          }
        });
      }

      // Filter by type
      if (type) {
        filteredProperties = filteredProperties.filter(property =>
          property.typeValue === type
        );
      }

      return filteredProperties;
    }

    // Render filtered properties
    function renderProperties(properties) {
      console.log('Rendering properties:', properties.length, 'properties found');
      console.log('Properties grid element:', propertiesGrid);
      if (!propertiesGrid) {
        console.error('Properties grid not found!');
        return;
      }

      if (properties.length === 0) {
        propertiesGrid.innerHTML = `
          <div class="col-span-full text-center py-12">
            <div class="text-gray-500 text-lg">
              No properties found matching your criteria.
            </div>
            <button onclick="clearFilters()" class="mt-4 text-sba-navy hover:text-sba-navy-dark font-medium">
              Clear filters
            </button>
          </div>
        `;
        return;
      }

      propertiesGrid.innerHTML = properties.map(warehouse => `
        <div class="group cursor-pointer transition-all duration-200">
          <div class="relative overflow-hidden rounded-lg mb-3" style="aspect-ratio: 20/19;">
            <img
              src="${warehouse.image}"
              alt="${warehouse.title}"
              class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"
            />
          </div>
          <div class="space-y-2">
            <h3 class="font-semibold text-sba-navy text-sm leading-tight">
              ${warehouse.title}
            </h3>
            <p class="text-gray-600 text-sm">
              ${warehouse.location}
            </p>
            <div class="flex items-center justify-between">
              <div class="text-sm text-gray-600">
                ${warehouse.size} • ${warehouse.type}
              </div>
              <div class="font-semibold text-sba-navy">
                ${warehouse.price}/SF
              </div>
            </div>
          </div>
        </div>
      `).join('');
    }

    // Clear filters function (make it global so button can access it)
    window.clearFilters = function() {
      if (countySelect) countySelect.value = '';
      if (sizeSelect) sizeSelect.value = '';
      if (typeSelect) typeSelect.value = '';
      renderProperties(Object.values(warehouseData).flat());
    };

    // Live filtering - no search button needed
    function performLiveFilter() {
      const filteredProperties = filterProperties();
      renderProperties(filteredProperties);
    }

    // Add live filtering to all select elements
    if (countySelect) {
      console.log('County select found, adding listener');
      countySelect.addEventListener('change', function() {
        console.log('County changed to:', countySelect.value);
        performLiveFilter();
      });
    } else {
      console.log('County select not found');
    }

    if (sizeSelect) {
      console.log('Size select found, adding listener');
      sizeSelect.addEventListener('change', function() {
        console.log('Size changed to:', sizeSelect.value);
        performLiveFilter();
      });
    } else {
      console.log('Size select not found');
    }

    if (typeSelect) {
      console.log('Type select found, adding listener');
      typeSelect.addEventListener('change', function() {
        console.log('Type changed to:', typeSelect.value);
        performLiveFilter();
      });
    } else {
      console.log('Type select not found');
    }


    // Enhanced search bar interactions
    if (floatingSearchBar) {
      // Add focus states
      const inputs = floatingSearchBar.querySelectorAll('input, select');
      inputs.forEach(input => {
        input.addEventListener('focus', function() {
          floatingSearchBar.classList.add('shadow-2xl');
          floatingSearchBar.classList.remove('shadow-lg');
        });

        input.addEventListener('blur', function() {
          // Delay to allow for clicking search button
          setTimeout(() => {
            if (!floatingSearchBar.contains(document.activeElement)) {
              floatingSearchBar.classList.remove('shadow-2xl');
              floatingSearchBar.classList.add('shadow-lg');
            }
          }, 100);
        });
      });
    }
  });
</script>