---
import BaseLayout from '../layouts/BaseLayout.astro';
import Navigation from '../components/Navigation.astro';
import MobileAppHeader from '../components/MobileAppHeader.astro';
import Footer from '../components/Footer.astro';

// Warehouse data for filtering
const warehousesByCounty = {
  "Miami-Dade": [
    {
      id: 1,
      title: "Modern Distribution Center",
      location: "Doral, FL",
      size: "85,000 SF",
      sizeValue: 85000,
      price: "$12.50",
      type: "Distribution",
      image: "https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=800&h=600&fit=crop",
      available: true,
      county: "Miami-Dade",
      description: "Premium distribution center featuring modern dock-high loading, 32-foot clear heights, and excellent highway access.",
      features: ["Dock High Loading", "32' Clear Height", "Highway Access", "LED Lighting", "ESFR Sprinkler System"],
      address: "8200 NW 36th St, Doral, FL 33166",
      lat: 25.8198,
      lng: -80.3565
    },
    {
      id: 2,
      title: "Prime Warehouse Space",
      location: "Hialeah, FL",
      size: "45,000 SF",
      sizeValue: 45000,
      price: "$10.75",
      type: "Warehouse",
      image: "https://images.unsplash.com/photo-1565884280-4e2b1f6b1b1e?w=800&h=600&fit=crop",
      available: true,
      county: "Miami-Dade",
      description: "Well-maintained warehouse space in prime Hialeah location. Features grade-level and dock-high doors.",
      features: ["Grade Level Doors", "Dock High Doors", "Flexible Layout", "Ample Parking"],
      address: "1150 W 29th St, Hialeah, FL 33012",
      lat: 25.8387,
      lng: -80.3348
    },
    {
      id: 3,
      title: "Manufacturing Facility",
      location: "Miami, FL",
      size: "120,000 SF",
      sizeValue: 120000,
      price: "$15.00",
      type: "Manufacturing",
      image: "https://images.unsplash.com/photo-1504307651254-35680f356dfd?w=800&h=600&fit=crop",
      available: true,
      county: "Miami-Dade",
      description: "Large-scale manufacturing facility with heavy power and crane-ready infrastructure.",
      features: ["Heavy Power", "Crane Ready", "High Ceilings", "Rail Access"],
      address: "3800 NW 25th St, Miami, FL 33142",
      lat: 25.7717,
      lng: -80.3018
    },
    {
      id: 7,
      title: "Cold Storage Facility",
      location: "Miami Beach, FL",
      size: "35,000 SF",
      sizeValue: 35000,
      price: "$18.00",
      type: "Cold Storage",
      image: "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800&h=600&fit=crop",
      available: true,
      county: "Miami-Dade",
      description: "State-of-the-art cold storage facility with temperature-controlled environments and food-grade standards.",
      features: ["Temperature Controlled", "Food Grade", "24/7 Security", "Loading Docks"],
      address: "500 Alton Rd, Miami Beach, FL 33139",
      lat: 25.7907,
      lng: -80.1300
    }
  ],
  "Broward": [
    {
      id: 4,
      title: "Flex Industrial Space",
      location: "Pompano Beach, FL",
      size: "25,000 SF",
      sizeValue: 25000,
      price: "$14.25",
      type: "Flex Space",
      image: "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800&h=600&fit=crop",
      available: true,
      county: "Broward",
      description: "Versatile flex industrial space perfect for light manufacturing, assembly, or warehouse operations with office component.",
      features: ["Office Space", "Drive-In Doors", "Flexible Layout", "Good Highway Access"],
      address: "1200 N Federal Hwy, Pompano Beach, FL 33062",
      lat: 26.2379,
      lng: -80.1248
    },
    {
      id: 5,
      title: "Logistics Hub",
      location: "Fort Lauderdale, FL",
      size: "95,000 SF",
      sizeValue: 95000,
      price: "$11.80",
      type: "Distribution",
      image: "https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=800&h=600&fit=crop",
      available: true,
      county: "Broward",
      description: "Large-scale logistics and distribution facility with excellent interstate access and modern dock facilities.",
      features: ["Multiple Dock Doors", "Interstate Access", "Cross-Dock Design", "24-Hour Operations"],
      address: "3600 Davie Blvd, Fort Lauderdale, FL 33312",
      lat: 26.1224,
      lng: -80.2994
    },
    {
      id: 9,
      title: "Distribution Warehouse",
      location: "Hollywood, FL",
      size: "75,000 SF",
      sizeValue: 75000,
      price: "$13.25",
      type: "Distribution",
      image: "https://images.unsplash.com/photo-1565884280-4e2b1f6b1b1e?w=800&h=600&fit=crop",
      available: true,
      county: "Broward",
      description: "Modern distribution warehouse with high-efficiency LED lighting and climate-controlled office areas.",
      features: ["LED Lighting", "Climate Controlled Office", "Clear Span Design", "Ample Trailer Parking"],
      address: "2850 Stirling Rd, Hollywood, FL 33312",
      lat: 26.0112,
      lng: -80.1495
    },
    {
      id: 11,
      title: "Port Access Facility",
      location: "Dania Beach, FL",
      size: "60,000 SF",
      sizeValue: 60000,
      price: "$12.75",
      type: "Warehouse",
      image: "https://images.unsplash.com/photo-1504307651254-35680f356dfd?w=800&h=600&fit=crop",
      available: true,
      county: "Broward",
      description: "Strategic warehouse location with direct port access for import/export operations and container storage.",
      features: ["Port Access", "Container Storage", "Customs Bonded", "Security Fencing"],
      address: "101 SE 2nd Ave, Dania Beach, FL 33004",
      lat: 26.0523,
      lng: -80.1439
    }
  ],
  "Palm Beach": [
    {
      id: 6,
      title: "Industrial Complex",
      location: "Boca Raton, FL",
      size: "65,000 SF",
      sizeValue: 65000,
      price: "$13.50",
      type: "Warehouse",
      image: "https://images.unsplash.com/photo-1565884280-4e2b1f6b1b1e?w=800&h=600&fit=crop",
      available: true,
      county: "Palm Beach",
      description: "Premium industrial complex in Boca Raton with modern amenities and professional office spaces.",
      features: ["Professional Offices", "Modern Loading", "Secure Access", "Landscaped Grounds"],
      address: "6500 Park of Commerce Blvd, Boca Raton, FL 33487",
      lat: 26.3683,
      lng: -80.1289
    },
    {
      id: 10,
      title: "Tech Manufacturing Hub",
      location: "Delray Beach, FL",
      size: "110,000 SF",
      sizeValue: 110000,
      price: "$16.75",
      type: "Manufacturing",
      image: "https://images.unsplash.com/photo-1504307651254-35680f356dfd?w=800&h=600&fit=crop",
      available: true,
      county: "Palm Beach",
      description: "High-tech manufacturing facility with clean room capabilities and advanced utilities for precision operations.",
      features: ["Clean Room Ready", "Advanced Utilities", "High Power Load", "Precision HVAC"],
      address: "15000 Jog Rd, Delray Beach, FL 33446",
      lat: 26.4615,
      lng: -80.1918
    },
    {
      id: 12,
      title: "Multi-Use Industrial",
      location: "West Palm Beach, FL",
      size: "80,000 SF",
      sizeValue: 80000,
      price: "$14.50",
      type: "Flex Space",
      image: "https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=800&h=600&fit=crop",
      available: true,
      county: "Palm Beach",
      description: "Multi-use industrial facility combining warehouse, light manufacturing, and office space in one location.",
      features: ["Mixed Use Design", "Office Component", "Flexible Zoning", "Convenient Location"],
      address: "2800 Corporate Way, West Palm Beach, FL 33407",
      lat: 26.7153,
      lng: -80.0533
    },
    {
      id: 13,
      title: "Distribution Center",
      location: "Boynton Beach, FL",
      size: "90,000 SF",
      sizeValue: 90000,
      price: "$13.25",
      type: "Distribution",
      image: "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800&h=600&fit=crop",
      available: true,
      county: "Palm Beach",
      description: "Efficient distribution center with modern material handling systems and excellent transportation access.",
      features: ["Material Handling Systems", "Transportation Access", "Energy Efficient", "Expansion Ready"],
      address: "1500 Old Boynton Rd, Boynton Beach, FL 33426",
      lat: 26.5312,
      lng: -80.0756
    }
  ],
  "St. Lucie": [
    {
      id: 14,
      title: "Port Industrial Center",
      location: "Port St. Lucie, FL",
      size: "55,000 SF",
      sizeValue: 55000,
      price: "$11.25",
      type: "Warehouse",
      image: "https://images.unsplash.com/photo-1565884280-4e2b1f6b1b1e?w=800&h=600&fit=crop",
      available: true,
      county: "St. Lucie",
      description: "Modern warehouse facility with excellent access to major transportation routes and port facilities.",
      features: ["Port Access", "Highway Access", "Modern Loading", "Secure Facility"],
      address: "2100 SE Salerno Rd, Port St. Lucie, FL 34952",
      lat: 27.2730,
      lng: -80.3582
    },
    {
      id: 15,
      title: "Treasure Coast Distribution",
      location: "Fort Pierce, FL",
      size: "85,000 SF",
      sizeValue: 85000,
      price: "$10.50",
      type: "Distribution",
      image: "https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=800&h=600&fit=crop",
      available: true,
      county: "St. Lucie",
      description: "Large distribution center strategically located for efficient regional distribution operations.",
      features: ["Distribution Hub", "Cross-Dock Design", "Highway Access", "Regional Coverage"],
      address: "1800 S 25th St, Fort Pierce, FL 34947",
      lat: 27.4467,
      lng: -80.3256
    }
  ]
};
---

<BaseLayout title="Our Services | Shallow Bay Advisors">
  <Navigation />
  <MobileAppHeader />
  
  <main class="pt-20">
    <!-- Hero Section -->
    <section class="pt-16 md:pt-28 pb-12 md:pb-20">
      <div class="max-w-4xl mx-auto px-6 text-center">
        <h1 class="text-3xl md:text-5xl font-light text-gray-900 mb-6 font-['Poppins'] tracking-tight leading-tight">
          Our Services
        </h1>
        <p class="text-lg md:text-xl text-gray-600 max-w-2xl mx-auto leading-relaxed">
          Comprehensive commercial real estate services specializing in small bay industrial warehouses across South Florida.
        </p>
      </div>
    </section>

    <!-- Main Services -->
    <section class="py-16">
      <div class="max-w-6xl mx-auto px-6">
        <div class="grid md:grid-cols-3 gap-8">

          <!-- Tenant Representation -->
          <div class="bg-white border border-gray-200 rounded-xl p-8 hover:shadow-lg transition-all duration-200">
            <div class="w-12 h-12 bg-sba-navy/10 rounded-lg flex items-center justify-center mb-6">
              <svg class="w-6 h-6 text-sba-navy" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
              </svg>
            </div>

            <h3 class="text-lg font-semibold text-gray-900 mb-4">Tenant Representation</h3>
            <p class="text-gray-600 mb-4">We help businesses find the perfect small bay industrial warehouse space across South Florida.</p>

            <ul class="space-y-2 text-sm text-gray-600">
              <li class="flex items-start space-x-2">
                <div class="w-1.5 h-1.5 bg-sba-navy rounded-full mt-2 flex-shrink-0"></div>
                <span>Market search and property identification</span>
              </li>
              <li class="flex items-start space-x-2">
                <div class="w-1.5 h-1.5 bg-sba-navy rounded-full mt-2 flex-shrink-0"></div>
                <span>Property tours and evaluation</span>
              </li>
              <li class="flex items-start space-x-2">
                <div class="w-1.5 h-1.5 bg-sba-navy rounded-full mt-2 flex-shrink-0"></div>
                <span>Lease negotiation and terms review</span>
              </li>
              <li class="flex items-start space-x-2">
                <div class="w-1.5 h-1.5 bg-sba-navy rounded-full mt-2 flex-shrink-0"></div>
                <span>Transaction management through closing</span>
              </li>
            </ul>
          </div>

          <!-- Landlord Services -->
          <div class="bg-white border border-gray-200 rounded-xl p-8 hover:shadow-lg transition-all duration-200">
            <div class="w-12 h-12 bg-sba-navy/10 rounded-lg flex items-center justify-center mb-6">
              <svg class="w-6 h-6 text-sba-navy" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
              </svg>
            </div>

            <h3 class="text-lg font-semibold text-gray-900 mb-4">Landlord Services</h3>
            <p class="text-gray-600 mb-4">Comprehensive property management and leasing services for warehouse owners and investors.</p>

            <ul class="space-y-2 text-sm text-gray-600">
              <li class="flex items-start space-x-2">
                <div class="w-1.5 h-1.5 bg-sba-navy rounded-full mt-2 flex-shrink-0"></div>
                <span>Property marketing and tenant sourcing</span>
              </li>
              <li class="flex items-start space-x-2">
                <div class="w-1.5 h-1.5 bg-sba-navy rounded-full mt-2 flex-shrink-0"></div>
                <span>Market analysis and rent optimization</span>
              </li>
              <li class="flex items-start space-x-2">
                <div class="w-1.5 h-1.5 bg-sba-navy rounded-full mt-2 flex-shrink-0"></div>
                <span>Lease administration and renewals</span>
              </li>
              <li class="flex items-start space-x-2">
                <div class="w-1.5 h-1.5 bg-sba-navy rounded-full mt-2 flex-shrink-0"></div>
                <span>Property maintenance coordination</span>
              </li>
            </ul>
          </div>

          <!-- Investment Advisory -->
          <div class="bg-white border border-gray-200 rounded-xl p-8 hover:shadow-lg transition-all duration-200">
            <div class="w-12 h-12 bg-sba-navy/10 rounded-lg flex items-center justify-center mb-6">
              <svg class="w-6 h-6 text-sba-navy" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
              </svg>
            </div>

            <h3 class="text-lg font-semibold text-gray-900 mb-4">Investment Advisory</h3>
            <p class="text-gray-600 mb-4">Strategic guidance for investors looking to acquire or develop industrial warehouse properties.</p>

            <ul class="space-y-2 text-sm text-gray-600">
              <li class="flex items-start space-x-2">
                <div class="w-1.5 h-1.5 bg-sba-navy rounded-full mt-2 flex-shrink-0"></div>
                <span>Market research and opportunity identification</span>
              </li>
              <li class="flex items-start space-x-2">
                <div class="w-1.5 h-1.5 bg-sba-navy rounded-full mt-2 flex-shrink-0"></div>
                <span>Financial analysis and due diligence</span>
              </li>
              <li class="flex items-start space-x-2">
                <div class="w-1.5 h-1.5 bg-sba-navy rounded-full mt-2 flex-shrink-0"></div>
                <span>Investment strategy development</span>
              </li>
              <li class="flex items-start space-x-2">
                <div class="w-1.5 h-1.5 bg-sba-navy rounded-full mt-2 flex-shrink-0"></div>
                <span>Transaction structuring and execution</span>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Process Overview Section -->
    <section class="py-16 bg-gray-50">
      <div class="max-w-6xl mx-auto px-6">
        <div class="text-center mb-16">
          <h2 class="text-2xl md:text-3xl font-semibold text-gray-900 mb-4">
            How We Work With You
          </h2>
          <p class="text-lg text-gray-600 max-w-2xl mx-auto">
            Our streamlined process ensures you find the perfect warehouse space with minimal hassle and maximum value
          </p>
        </div>

        <!-- Process Steps with Connecting Line -->
        <div class="relative">
          <!-- Connecting Line (Desktop Only) -->
          <div class="hidden md:block absolute top-8 left-1/2 transform -translate-x-1/2 w-full max-w-4xl">
            <div class="absolute top-0 left-0 w-full h-0.5 bg-gradient-to-r from-sba-navy via-sba-navy to-sba-navy"></div>
          </div>

          <div class="grid md:grid-cols-4 gap-8 relative z-10">
            <!-- Step 1 -->
            <div class="text-center">
              <div class="w-16 h-16 bg-sba-navy rounded-full flex items-center justify-center mx-auto mb-6 relative">
                <span class="text-white font-bold text-xl">1</span>
              </div>
              <h3 class="text-lg font-semibold text-gray-900 mb-3">Initial Consultation</h3>
              <p class="text-gray-600 text-sm leading-relaxed">
                We discuss your specific requirements, timeline, budget, and operational needs to understand your perfect warehouse space
              </p>
            </div>

            <!-- Step 2 -->
            <div class="text-center">
              <div class="w-16 h-16 bg-sba-navy rounded-full flex items-center justify-center mx-auto mb-6 relative">
                <span class="text-white font-bold text-xl">2</span>
              </div>
              <h3 class="text-lg font-semibold text-gray-900 mb-3">Market Search</h3>
              <p class="text-gray-600 text-sm leading-relaxed">
                Our team conducts comprehensive market research to identify properties that match your criteria across our coverage area
              </p>
            </div>

            <!-- Step 3 -->
            <div class="text-center">
              <div class="w-16 h-16 bg-sba-navy rounded-full flex items-center justify-center mx-auto mb-6 relative">
                <span class="text-white font-bold text-xl">3</span>
              </div>
              <h3 class="text-lg font-semibold text-gray-900 mb-3">Property Tours</h3>
              <p class="text-gray-600 text-sm leading-relaxed">
                We arrange and accompany you on property tours, providing expert insights and helping you evaluate each option
              </p>
            </div>

            <!-- Step 4 -->
            <div class="text-center">
              <div class="w-16 h-16 bg-sba-navy rounded-full flex items-center justify-center mx-auto mb-6 relative">
                <span class="text-white font-bold text-xl">4</span>
              </div>
              <h3 class="text-lg font-semibold text-gray-900 mb-3">Lease Negotiation</h3>
              <p class="text-gray-600 text-sm leading-relaxed">
                We negotiate the best terms on your behalf and manage the entire transaction process through closing
              </p>
            </div>
          </div>
        </div>

        <!-- CTA -->
        <div class="text-center mt-12">
          <p class="text-gray-600 mb-6">Ready to get started? Our services are completely free to tenants.</p>
          <a
            href="/book-consultation"
            class="inline-flex items-center px-8 py-3 bg-sba-navy text-white font-semibold rounded-xl hover:bg-sba-navy-dark transition-all duration-200 shadow-lg hover:shadow-xl"
          >
            Start Your Search Today
            <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
            </svg>
          </a>
        </div>
      </div>
    </section>

    <!-- Search for Properties Section -->
    <section class="py-16">
      <div class="max-w-6xl mx-auto px-6">
        <div class="text-center mb-12">
          <h2 class="text-2xl md:text-3xl font-semibold text-gray-900 mb-4">
            Search Available Properties
          </h2>
          <p class="text-gray-600">
            Use the filters below to find properties that match your needs
          </p>
        </div>

        <!-- Desktop Search Bar -->
        <div class="hidden sm:flex justify-center mb-16">
          <div id="floating-search-bar" class="bg-white border border-gray-300 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 p-1 max-w-4xl w-full">
            <div class="flex items-center">
              <div class="flex-1 px-6 py-4 border-r border-gray-300">
                <div class="text-xs font-semibold text-gray-700 mb-1">County</div>
                <select id="county-select" class="text-sm text-gray-800 w-full border-none outline-none bg-transparent appearance-none cursor-pointer">
                  <option value="">All counties</option>
                  <option value="Miami-Dade">Miami-Dade</option>
                  <option value="Broward">Broward</option>
                  <option value="Palm Beach">Palm Beach</option>
                  <option value="St. Lucie">St. Lucie</option>
                </select>
              </div>
              <div class="flex-1 px-6 py-4 border-r border-gray-300">
                <div class="text-xs font-semibold text-gray-700 mb-1">Size</div>
                <select id="size-select" class="text-sm text-gray-800 w-full border-none outline-none bg-transparent appearance-none cursor-pointer">
                  <option value="">Any size</option>
                  <option value="small">5K - 25K SF</option>
                  <option value="medium">25K - 100K SF</option>
                  <option value="large">100K+ SF</option>
                </select>
              </div>
              <div class="flex-1 px-6 py-4">
                <div class="text-xs font-semibold text-gray-700 mb-1">Type</div>
                <select id="type-select" class="text-sm text-gray-800 w-full border-none outline-none bg-transparent appearance-none cursor-pointer">
                  <option value="">All types</option>
                  <option value="warehouse">Warehouse</option>
                  <option value="distribution">Distribution</option>
                  <option value="manufacturing">Manufacturing</option>
                  <option value="flex">Flex Space</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <!-- Mobile Filter Bar -->
        <div class="sm:hidden mb-6">
          <div id="mobile-search-bar" class="bg-white border border-gray-200 rounded-xl shadow-md hover:shadow-lg transition-all duration-200 mx-4 overflow-hidden">
            <div class="flex">
              <div class="flex-1 px-3 py-3 border-r border-gray-100">
                <div class="text-xs font-semibold text-gray-700 mb-1">County</div>
                <select id="mobile-county-select" class="text-xs text-gray-800 w-full border-none outline-none bg-transparent appearance-none cursor-pointer">
                  <option value="">All counties</option>
                  <option value="Miami-Dade">Miami-Dade</option>
                  <option value="Broward">Broward</option>
                  <option value="Palm Beach">Palm Beach</option>
                  <option value="St. Lucie">St. Lucie</option>
                </select>
              </div>
              <div class="flex-1 px-3 py-3 border-r border-gray-100">
                <div class="text-xs font-semibold text-gray-700 mb-1">Size</div>
                <select id="mobile-size-select" class="text-xs text-gray-800 w-full border-none outline-none bg-transparent appearance-none cursor-pointer">
                  <option value="">Any size</option>
                  <option value="small">5K - 25K SF</option>
                  <option value="medium">25K - 100K SF</option>
                  <option value="large">100K+ SF</option>
                </select>
              </div>
              <div class="flex-1 px-3 py-3">
                <div class="text-xs font-semibold text-gray-700 mb-1">Type</div>
                <select id="mobile-type-select" class="text-xs text-gray-800 w-full border-none outline-none bg-transparent appearance-none cursor-pointer">
                  <option value="">All types</option>
                  <option value="warehouse">Warehouse</option>
                  <option value="distribution">Distribution</option>
                  <option value="manufacturing">Manufacturing</option>
                  <option value="flex">Flex Space</option>
                </select>
              </div>
            </div>
          </div>
        </div>


        <!-- Properties Results -->
        <div id="no-filters-message" class="text-center py-12">
          <div class="text-gray-500 text-lg mb-4">
            Select filters above to see available properties
          </div>
          <p class="text-gray-400 text-sm">
            Use county, size, or type filters to find properties that match your needs
          </p>
        </div>

        <!-- Mobile Properties -->
        <div class="sm:hidden">
          <div id="mobile-properties" class="flex gap-3 overflow-x-auto pb-4 scrollbar-hide px-4 hidden" style="scroll-snap-type: x mandatory; margin-right: -1rem;">
          </div>
        </div>

        <!-- Desktop Properties Grid -->
        <div id="desktop-properties" class="hidden sm:grid sm:grid-cols-4 sm:gap-3 lg:grid-cols-5 lg:gap-4 xl:gap-6 properties-hidden">
        </div>

        <!-- Interactive Map View -->
        <div id="map-container" class="hidden bg-white rounded-xl shadow-lg overflow-hidden mt-12">
          <div class="p-4 border-b border-gray-200">
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Property Locations</h3>
            <p class="text-sm text-gray-600">Click on any marker to view property details</p>
          </div>

          <div class="h-96 md:h-[500px] relative">
            <div id="properties-map" class="w-full h-full">
              <!-- Leaflet map will be initialized here -->
            </div>
          </div>

          <!-- Selected Property Card -->
          <div id="map-property-cards" class="border-t border-gray-200 bg-gray-50 min-h-16">
            <div class="p-4 text-sm text-gray-500 text-center">
              Click on a property marker above to view details
            </div>
          </div>
        </div>

        <!-- View All Properties Button -->
        <div id="view-all-button" class="text-center mt-12 hidden">
          <a
            href="/contact"
            class="inline-flex items-center px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-900 font-semibold rounded-2xl transition-all duration-200"
          >
            Show all properties
            <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
            </svg>
          </a>
        </div>
      </div>
    </section>
  </main>
  
  <Footer />
</BaseLayout>

<style>
  /* Clean minimal styling */
  select {
    appearance: none;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
    background-position: right 12px center;
    background-repeat: no-repeat;
    background-size: 16px;
  }

  select:focus,
  input:focus {
    outline: none;
  }

  html {
    scroll-behavior: smooth;
  }

  /* Text truncation utilities */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Airbnb-style horizontal scroll */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Mobile property cards - Airbnb style */
  @media (max-width: 640px) {
    .property-container {
      padding-right: calc(10% + 1rem);
    }
  }

  /* Mobile app-style adjustments */
  @media (max-width: 768px) {
    .container {
      padding-left: 1rem;
      padding-right: 1rem;
    }
  }

  select:focus-visible,
  button:focus-visible,
  a:focus-visible {
    outline: 2px solid #1f2937;
    outline-offset: 2px;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const floatingSearchBar = document.getElementById('floating-search-bar');
    const mobileSearchBar = document.getElementById('mobile-search-bar');
    const countySelect = document.getElementById('county-select');
    const sizeSelect = document.getElementById('size-select');
    const typeSelect = document.getElementById('type-select');

    // Mobile selectors
    const mobileCountySelect = document.getElementById('mobile-county-select');
    const mobileSizeSelect = document.getElementById('mobile-size-select');
    const mobileTypeSelect = document.getElementById('mobile-type-select');
    const mobileContainer = document.getElementById('mobile-properties');
    const desktopGrid = document.getElementById('desktop-properties');
    const noFiltersMessage = document.getElementById('no-filters-message');
    const viewAllButton = document.getElementById('view-all-button');

    // Map elements
    const mapContainer = document.getElementById('map-container');
    const propertiesMap = document.getElementById('properties-map');
    const mapPropertyCards = document.getElementById('map-property-cards');

    // All warehouse data for filtering - matching the type mapping from homepage
    const warehouseData = {
      "Miami-Dade": [
        {
          id: 1,
          title: "Modern Distribution Center",
          location: "Doral, FL",
          size: "85,000 SF",
          sizeValue: 85000,
          price: "$12.50",
          type: "Distribution",
          typeValue: "distribution",
          image: "https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=800&h=600&fit=crop",
          available: true,
          lat: 25.8198,
          lng: -80.3565
        },
        {
          id: 2,
          title: "Prime Warehouse Space",
          location: "Hialeah, FL",
          size: "45,000 SF",
          sizeValue: 45000,
          price: "$10.75",
          type: "Warehouse",
          typeValue: "warehouse",
          image: "https://images.unsplash.com/photo-1565884280-4e2b1f6b1b1e?w=800&h=600&fit=crop",
          available: true,
          lat: 25.8387,
          lng: -80.3348
        },
        {
          id: 3,
          title: "Manufacturing Facility",
          location: "Miami, FL",
          size: "120,000 SF",
          sizeValue: 120000,
          price: "$15.00",
          type: "Manufacturing",
          typeValue: "manufacturing",
          image: "https://images.unsplash.com/photo-1504307651254-35680f356dfd?w=800&h=600&fit=crop",
          available: true,
          lat: 25.7717,
          lng: -80.3018
        },
        {
          id: 7,
          title: "Cold Storage Facility",
          location: "Miami Beach, FL",
          size: "35,000 SF",
          sizeValue: 35000,
          price: "$18.00",
          type: "Cold Storage",
          typeValue: "warehouse",
          image: "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800&h=600&fit=crop",
          available: true,
          lat: 25.7907,
          lng: -80.1300
        }
      ],
      "Broward": [
        {
          id: 4,
          title: "Flex Industrial Space",
          location: "Pompano Beach, FL",
          size: "25,000 SF",
          sizeValue: 25000,
          price: "$14.25",
          type: "Flex Space",
          typeValue: "flex",
          image: "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800&h=600&fit=crop",
          available: true,
          lat: 26.2379,
          lng: -80.1248
        },
        {
          id: 5,
          title: "Logistics Hub",
          location: "Fort Lauderdale, FL",
          size: "95,000 SF",
          sizeValue: 95000,
          price: "$11.80",
          type: "Distribution",
          typeValue: "distribution",
          image: "https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=800&h=600&fit=crop",
          available: true,
          lat: 26.1224,
          lng: -80.2994
        },
        {
          id: 9,
          title: "Distribution Warehouse",
          location: "Hollywood, FL",
          size: "75,000 SF",
          sizeValue: 75000,
          price: "$13.25",
          type: "Distribution",
          typeValue: "distribution",
          image: "https://images.unsplash.com/photo-1565884280-4e2b1f6b1b1e?w=800&h=600&fit=crop",
          available: true,
          lat: 26.0112,
          lng: -80.1495
        },
        {
          id: 11,
          title: "Port Access Facility",
          location: "Dania Beach, FL",
          size: "60,000 SF",
          sizeValue: 60000,
          price: "$12.75",
          type: "Warehouse",
          typeValue: "warehouse",
          image: "https://images.unsplash.com/photo-1504307651254-35680f356dfd?w=800&h=600&fit=crop",
          available: true,
          lat: 26.0523,
          lng: -80.1439
        }
      ],
      "Palm Beach": [
        {
          id: 6,
          title: "Industrial Complex",
          location: "Boca Raton, FL",
          size: "65,000 SF",
          sizeValue: 65000,
          price: "$13.50",
          type: "Warehouse",
          typeValue: "warehouse",
          image: "https://images.unsplash.com/photo-1565884280-4e2b1f6b1b1e?w=800&h=600&fit=crop",
          available: true,
          lat: 26.3683,
          lng: -80.1289
        },
        {
          id: 10,
          title: "Tech Manufacturing Hub",
          location: "Delray Beach, FL",
          size: "110,000 SF",
          sizeValue: 110000,
          price: "$16.75",
          type: "Manufacturing",
          typeValue: "manufacturing",
          image: "https://images.unsplash.com/photo-1504307651254-35680f356dfd?w=800&h=600&fit=crop",
          available: true,
          lat: 26.4615,
          lng: -80.1918
        },
        {
          id: 12,
          title: "Multi-Use Industrial",
          location: "West Palm Beach, FL",
          size: "80,000 SF",
          sizeValue: 80000,
          price: "$14.50",
          type: "Flex Space",
          typeValue: "flex",
          image: "https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=800&h=600&fit=crop",
          available: true,
          lat: 26.7153,
          lng: -80.0533
        },
        {
          id: 13,
          title: "Distribution Center",
          location: "Boynton Beach, FL",
          size: "90,000 SF",
          sizeValue: 90000,
          price: "$13.25",
          type: "Distribution",
          typeValue: "distribution",
          image: "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800&h=600&fit=crop",
          available: true,
          lat: 26.5312,
          lng: -80.0756
        }
      ],
      "St. Lucie": [
        {
          id: 14,
          title: "Port Industrial Center",
          location: "Port St. Lucie, FL",
          size: "55,000 SF",
          sizeValue: 55000,
          price: "$11.25",
          type: "Warehouse",
          typeValue: "warehouse",
          image: "https://images.unsplash.com/photo-1565884280-4e2b1f6b1b1e?w=800&h=600&fit=crop",
          available: true,
          lat: 27.2730,
          lng: -80.3582
        },
        {
          id: 15,
          title: "Treasure Coast Distribution",
          location: "Fort Pierce, FL",
          size: "85,000 SF",
          sizeValue: 85000,
          price: "$10.50",
          type: "Distribution",
          typeValue: "distribution",
          image: "https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=800&h=600&fit=crop",
          available: true,
          lat: 27.4467,
          lng: -80.3256
        }
      ]
    };

    // Filter properties based on search criteria
    function filterProperties() {
      const county = (countySelect ? countySelect.value : '') || (mobileCountySelect ? mobileCountySelect.value : '');
      const size = (sizeSelect ? sizeSelect.value : '') || (mobileSizeSelect ? mobileSizeSelect.value : '');
      const type = (typeSelect ? typeSelect.value : '') || (mobileTypeSelect ? mobileTypeSelect.value : '');

      // Check if any filter is selected
      const hasFilters = county || size || type;

      if (!hasFilters) {
        // Show no filters message and hide properties
        if (noFiltersMessage) noFiltersMessage.style.display = 'block';
        if (mobileContainer) mobileContainer.classList.add('hidden');
        if (desktopGrid) desktopGrid.classList.add('properties-hidden');
        if (viewAllButton) viewAllButton.classList.add('hidden');
        return [];
      }

      let filteredProperties = [];

      // Get all properties or filter by county
      if (county) {
        filteredProperties = warehouseData[county] || [];
      } else {
        // Get all properties from all counties
        filteredProperties = Object.values(warehouseData).flat();
      }

      // Filter by size
      if (size) {
        filteredProperties = filteredProperties.filter(property => {
          switch (size) {
            case 'small':
              return property.sizeValue >= 5000 && property.sizeValue <= 25000;
            case 'medium':
              return property.sizeValue > 25000 && property.sizeValue <= 100000;
            case 'large':
              return property.sizeValue > 100000;
            default:
              return true;
          }
        });
      }

      // Filter by type
      if (type) {
        filteredProperties = filteredProperties.filter(property =>
          property.typeValue === type
        );
      }

      return filteredProperties;
    }

    // Render filtered properties
    function renderProperties(properties) {
      const hasFilters = properties.length > 0 ||
        (countySelect && countySelect.value) ||
        (sizeSelect && sizeSelect.value) ||
        (typeSelect && typeSelect.value) ||
        (mobileCountySelect && mobileCountySelect.value) ||
        (mobileSizeSelect && mobileSizeSelect.value) ||
        (mobileTypeSelect && mobileTypeSelect.value);

      if (!hasFilters) {
        // Show no filters message
        if (noFiltersMessage) noFiltersMessage.style.display = 'block';
        if (mobileContainer) mobileContainer.classList.add('hidden');
        if (desktopGrid) desktopGrid.classList.add('properties-hidden');
        if (viewAllButton) viewAllButton.classList.add('hidden');
        return;
      }

      // Hide no filters message
      if (noFiltersMessage) noFiltersMessage.style.display = 'none';

      if (properties.length === 0) {
        const noResultsHTML = `
          <div class="col-span-full text-center py-12">
            <div class="text-gray-500 text-lg">
              No properties found matching your criteria.
            </div>
            <button onclick="clearFilters()" class="mt-4 text-sba-navy hover:text-sba-navy-dark font-medium">
              Clear filters
            </button>
          </div>
        `;

        if (mobileContainer) {
          mobileContainer.innerHTML = noResultsHTML;
          mobileContainer.classList.remove('hidden');
        }
        if (desktopGrid) {
          desktopGrid.innerHTML = noResultsHTML;
          desktopGrid.classList.remove('properties-hidden');
        }
        if (viewAllButton) viewAllButton.classList.add('hidden');
        return;
      }

      // Show properties and view all button
      if (mobileContainer) mobileContainer.classList.remove('hidden');
      if (desktopGrid) desktopGrid.classList.remove('properties-hidden');
      if (viewAllButton) viewAllButton.classList.remove('hidden');

      // Mobile horizontal scroll layout
      const mobileHTML = properties.map(warehouse => `
        <a href="/property/${warehouse.id}" class="block group flex-none" style="scroll-snap-align: start; width: calc((100vw - 2rem - 1rem) / 2.1);">
          <div class="bg-white rounded-xl overflow-hidden">
            <div class="relative overflow-hidden rounded-xl" style="aspect-ratio: 1.15/1;">
              <img
                src="${warehouse.image}"
                alt="${warehouse.title}"
                class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
              />
            </div>
            <div class="pt-3">
              <h3 class="font-medium text-gray-900 text-sm leading-snug mb-1 line-clamp-2">
                ${warehouse.title}
              </h3>
              <p class="text-gray-500 text-sm mb-1 truncate">
                ${warehouse.location}
              </p>
              <div class="text-sm text-gray-500 mb-1">
                <span class="truncate">${warehouse.size} • ${warehouse.type}</span>
              </div>
              <div class="text-sm font-semibold text-gray-900">
                ${warehouse.price}<span class="font-normal">/SF</span>
                ${warehouse.available ? '<span class="text-green-600 font-medium ml-2">Available</span>' : ''}
              </div>
            </div>
          </div>
        </a>
      `).join('');

      // Desktop grid layout
      const desktopHTML = properties.map(warehouse => `
        <a href="/property/${warehouse.id}" class="block group">
          <div class="bg-white rounded-xl overflow-hidden">
            <div class="relative overflow-hidden rounded-xl" style="aspect-ratio: 1.15/1;">
              <img
                src="${warehouse.image}"
                alt="${warehouse.title}"
                class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
              />
            </div>
            <div class="pt-2">
              <h3 class="font-medium text-gray-900 text-xs leading-snug mb-1 line-clamp-2">
                ${warehouse.title}
              </h3>
              <div class="text-sm font-semibold text-gray-900 mb-1">
                ${warehouse.price}<span class="font-normal">/SF</span>
              </div>
              <p class="text-gray-500 text-xs mb-1 truncate">
                ${warehouse.location}
              </p>
              <div class="text-xs text-gray-500 space-y-1">
                <div class="flex items-center">
                  <span class="truncate">${warehouse.size}</span>
                </div>
                <div class="flex items-center justify-between">
                  <span class="truncate">${warehouse.type}</span>
                  ${warehouse.available ? '<span class="text-green-600 font-medium whitespace-nowrap">Available</span>' : ''}
                </div>
              </div>
            </div>
          </div>
        </a>
      `).join('');

      if (mobileContainer) mobileContainer.innerHTML = mobileHTML;
      if (desktopGrid) desktopGrid.innerHTML = desktopHTML;
    }

    // Clear filters function (make it global so button can access it)
    window.clearFilters = function() {
      if (countySelect) countySelect.value = '';
      if (sizeSelect) sizeSelect.value = '';
      if (typeSelect) typeSelect.value = '';
      if (mobileCountySelect) mobileCountySelect.value = '';
      if (mobileSizeSelect) mobileSizeSelect.value = '';
      if (mobileTypeSelect) mobileTypeSelect.value = '';
      renderProperties([]);
    };

    // Live filtering - no search button needed
    function performLiveFilter() {
      const filteredProperties = filterProperties();
      renderProperties(filteredProperties);
    }

    // Add live filtering to all select elements
    if (countySelect) {
      countySelect.addEventListener('change', performLiveFilter);
    }

    if (sizeSelect) {
      sizeSelect.addEventListener('change', performLiveFilter);
    }

    if (typeSelect) {
      typeSelect.addEventListener('change', performLiveFilter);
    }

    // Mobile filter event listeners
    if (mobileCountySelect) {
      mobileCountySelect.addEventListener('change', performLiveFilter);
    }

    if (mobileSizeSelect) {
      mobileSizeSelect.addEventListener('change', performLiveFilter);
    }

    if (mobileTypeSelect) {
      mobileTypeSelect.addEventListener('change', performLiveFilter);
    }

    // Enhanced search bar interactions
    if (floatingSearchBar) {
      const inputs = floatingSearchBar.querySelectorAll('input, select');
      inputs.forEach(input => {
        input.addEventListener('focus', function() {
          floatingSearchBar.classList.add('shadow-2xl');
          floatingSearchBar.classList.remove('shadow-lg');
        });

        input.addEventListener('blur', function() {
          setTimeout(() => {
            if (!floatingSearchBar.contains(document.activeElement)) {
              floatingSearchBar.classList.remove('shadow-2xl');
              floatingSearchBar.classList.add('shadow-lg');
            }
          }, 100);
        });
      });
    }

    // Enhanced mobile search bar interactions
    if (mobileSearchBar) {
      const mobileInputs = mobileSearchBar.querySelectorAll('input, select');
      mobileInputs.forEach(input => {
        input.addEventListener('focus', function() {
          mobileSearchBar.classList.add('shadow-2xl');
          mobileSearchBar.classList.remove('shadow-lg');
        });

        input.addEventListener('blur', function() {
          setTimeout(() => {
            if (!mobileSearchBar.contains(document.activeElement)) {
              mobileSearchBar.classList.remove('shadow-2xl');
              mobileSearchBar.classList.add('shadow-lg');
            }
          }, 100);
        });
      });
    }


    // Leaflet map instance
    let map = null;
    let markersLayer = null;

    // Initialize Leaflet map
    function initializeMap() {
      if (map) return; // Already initialized

      // Initialize the map centered on South Florida with scroll wheel zoom disabled
      map = L.map('properties-map', {
        scrollWheelZoom: false,
        doubleClickZoom: true,
        dragging: true,
        zoomControl: true
      }).setView([26.5, -80.2], 9);

      // Add tile layer (OpenStreetMap)
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OpenStreetMap contributors',
        maxZoom: 18
      }).addTo(map);

      // Create layer group for markers
      markersLayer = L.layerGroup().addTo(map);
    }

    // Render properties on the Leaflet map
    function renderMapView(properties) {
      if (!propertiesMap) return;

      // Initialize map if not already done
      initializeMap();

      // Clear existing markers
      if (markersLayer) {
        markersLayer.clearLayers();
      }

      if (properties.length === 0) return;

      // Create custom icon for properties
      const propertyIcon = L.divIcon({
        className: 'custom-property-marker',
        html: `
          <div class="w-8 h-8 bg-sba-navy rounded-full border-2 border-white shadow-lg flex items-center justify-center hover:scale-110 transition-transform duration-200">
            <div class="w-3 h-3 bg-white rounded-full"></div>
          </div>
        `,
        iconSize: [32, 32],
        iconAnchor: [16, 16]
      });

      // Add markers for each property
      const markers = [];
      properties.forEach(property => {
        const marker = L.marker([property.lat, property.lng], { icon: propertyIcon })
          .bindTooltip(`
            <div class="text-sm">
              <div class="font-semibold text-gray-900">${property.title}</div>
              <div class="text-gray-600">${property.location}</div>
              <div class="text-gray-500">${property.size} • ${property.type}</div>
              <div class="font-semibold text-sba-navy">${property.price}/SF</div>
            </div>
          `, {
            permanent: false,
            direction: 'top',
            offset: [0, -20]
          })
          .on('click', function() {
            showPropertyCard(property);
          });

        markers.push(marker);
        markersLayer.addLayer(marker);
      });

      // Fit map bounds to show all properties
      if (markers.length > 0) {
        const group = new L.featureGroup(markers);
        map.fitBounds(group.getBounds().pad(0.1));
      }
    }

    // Show property card in map view (GTA-style popup)
    function showPropertyCard(property) {
      if (!mapPropertyCards) return;

      const cardHTML = `
        <div class="bg-white m-4 rounded-xl border border-gray-200 shadow-lg p-6 transform transition-all duration-300 hover:shadow-xl">
          <div class="flex items-start space-x-6">
            <img
              src="${property.image}"
              alt="${property.title}"
              class="w-32 h-32 rounded-xl object-cover flex-shrink-0 shadow-md"
            />
            <div class="flex-1 min-w-0">
              <div class="flex items-start justify-between mb-3">
                <div>
                  <h3 class="font-bold text-gray-900 text-lg mb-1">${property.title}</h3>
                  <p class="text-gray-600 text-sm flex items-center">
                    <svg class="w-4 h-4 mr-1 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                    </svg>
                    ${property.location}
                  </p>
                </div>
                <div class="text-right">
                  <div class="text-2xl font-bold text-sba-navy">${property.price}</div>
                  <div class="text-sm text-gray-500">/SF per month</div>
                </div>
              </div>

              <div class="grid grid-cols-2 gap-4 mb-4">
                <div class="bg-gray-50 rounded-lg p-3">
                  <div class="text-xs text-gray-500 mb-1">Size</div>
                  <div class="font-semibold text-gray-900">${property.size}</div>
                </div>
                <div class="bg-gray-50 rounded-lg p-3">
                  <div class="text-xs text-gray-500 mb-1">Type</div>
                  <div class="font-semibold text-gray-900">${property.type}</div>
                </div>
              </div>

              <div class="flex items-center justify-between">
                <div class="flex items-center space-x-2">
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                    ${property.available ? 'Available Now' : 'Contact for Availability'}
                  </span>
                </div>
                <a
                  href="/property/${property.id}"
                  class="inline-flex items-center px-4 py-2 bg-sba-navy text-white font-semibold rounded-lg hover:bg-sba-navy-dark transition-all duration-200 shadow-sm hover:shadow-md"
                >
                  View Full Details
                  <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                  </svg>
                </a>
              </div>
            </div>
          </div>
        </div>
      `;

      mapPropertyCards.innerHTML = cardHTML;
    }

    // Update renderProperties to handle both list and map
    const originalRenderProperties = renderProperties;
    renderProperties = function(properties) {
      const hasFilters = properties.length > 0 ||
        (countySelect && countySelect.value) ||
        (sizeSelect && sizeSelect.value) ||
        (typeSelect && typeSelect.value) ||
        (mobileCountySelect && mobileCountySelect.value) ||
        (mobileSizeSelect && mobileSizeSelect.value) ||
        (mobileTypeSelect && mobileTypeSelect.value);

      // Call original render function for list view
      originalRenderProperties(properties);

      // Show map below list when we have properties
      if (hasFilters && properties.length > 0) {
        if (mapContainer) mapContainer.classList.remove('hidden');
        // Small delay to ensure the map container is visible before initializing
        setTimeout(() => {
          renderMapView(properties);
          // Invalidate size to ensure proper map rendering
          if (map) {
            map.invalidateSize();
          }
        }, 100);
        // Reset property card area
        if (mapPropertyCards) {
          mapPropertyCards.innerHTML = `
            <div class="p-4 text-sm text-gray-500 text-center">
              Click on a property marker above to view details
            </div>
          `;
        }
      } else {
        // Hide map when no results
        if (mapContainer) mapContainer.classList.add('hidden');
      }
    };

    // Initialize with no properties showing
    renderProperties([]);
  });
</script>